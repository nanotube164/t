import{r as g,cn as y,co as x,cp as T,cq as V,a7 as ie,cr as W,cs as ae,ct as oe,cu as fe,cv as de,cw as ue,cx as ve,cy as $,cz as me,j as f,i as he,g as J,U as L,W as D,c9 as Q,I as Z}from"./index-tKRtgB90.js";import{T as ge}from"./Table-o5vjsNVU.js";import{a as pe,_ as be,c as ye,i as K}from"./isObjectLike-TLVQEH5a.js";import{F as R}from"./index-cdWWgjTx.js";import{R as xe,C as B}from"./row-WvoE6FX3.js";import{I as G}from"./index-VAcXbeIy.js";import{S as z}from"./index-TjmR82pg.js";import{P as je}from"./index-B4XA4tlu.js";import{M as we,I as Pe}from"./index-dnDdURN_.js";import{R as H}from"./index-ByH9SYTg.js";import"./styleChecker-ngeleDYd.js";import"./addEventListener-EDtlfxlh.js";import"./List-K1aq5hik.js";import"./iconUtil-lb11mAsn.js";import"./index-ct8nSeFk.js";import"./index-Hp8F7D4k.js";import"./index-_Ebqtiwf.js";import"./useShowArrow-Kbh98tcw.js";import"./CheckOutlined-g5MDPs9I.js";import"./SearchOutlined-wP6Gi4z0.js";import"./Pagination-cdi9UDqR.js";import"./index-qxJHRbnC.js";import"./index-tAzqEXvb.js";import"./extendsObject-h5XtBT9o.js";import"./TextArea-hTdCA0yJ.js";import"./EyeOutlined-lDKO_IOm.js";import"./index-hPDjsNpv.js";var Re=function(e){return function(r,n){var i=g.useRef(!1);e(function(){return function(){i.current=!1}},[]),e(function(){if(!i.current)i.current=!0;else return r()},n)}};const q=Re(g.useEffect);var se=function(e,r){var n=r.manual,i=r.ready,a=i===void 0?!0:i,o=r.defaultParams,u=o===void 0?[]:o,s=r.refreshDeps,c=s===void 0?[]:s,t=r.refreshDepsAction,l=g.useRef(!1);return l.current=!1,q(function(){!n&&a&&(l.current=!0,e.run.apply(e,y([],x(u),!1)))},[a]),q(function(){l.current||n||(l.current=!0,t?t():e.refresh())},y([],x(c),!1)),{onBefore:function(){if(!a)return{stopNow:!0}}}};se.onInit=function(e){var r=e.ready,n=r===void 0?!0:r,i=e.manual;return{loading:!i&&n}};const Te=se;function Ce(e,r){if(e===r)return!0;for(var n=0;n<e.length;n++)if(!Object.is(e[n],r[n]))return!1;return!0}function ce(e,r){var n=g.useRef({deps:r,obj:void 0,initialized:!1}).current;return(n.initialized===!1||!Ce(n.deps,r))&&(n.deps=r,n.obj=e(),n.initialized=!0),n.obj}var N=new Map,Se=function(e,r,n){var i=N.get(e);i!=null&&i.timer&&clearTimeout(i.timer);var a=void 0;r>-1&&(a=setTimeout(function(){N.delete(e)},r)),N.set(e,T(T({},n),{timer:a}))},Ee=function(e){return N.get(e)},M=new Map,Oe=function(e){return M.get(e)},$e=function(e,r){M.set(e,r),r.then(function(n){return M.delete(e),n}).catch(function(){M.delete(e)})},E={},Ae=function(e,r){E[e]&&E[e].forEach(function(n){return n(r)})},U=function(e,r){return E[e]||(E[e]=[]),E[e].push(r),function(){var i=E[e].indexOf(r);E[e].splice(i,1)}},Fe=function(e,r){var n=r.cacheKey,i=r.cacheTime,a=i===void 0?5*60*1e3:i,o=r.staleTime,u=o===void 0?0:o,s=r.setCache,c=r.getCache,t=g.useRef(),l=g.useRef(),d=function(v,m){s?s(m):Se(v,a,m),Ae(v,m.data)},p=function(v,m){return m===void 0&&(m=[]),c?c(m):Ee(v)};return ce(function(){if(n){var v=p(n);v&&Object.hasOwnProperty.call(v,"data")&&(e.state.data=v.data,e.state.params=v.params,(u===-1||new Date().getTime()-v.time<=u)&&(e.state.loading=!1)),t.current=U(n,function(m){e.setState({data:m})})}},[]),V(function(){var v;(v=t.current)===null||v===void 0||v.call(t)}),n?{onBefore:function(v){var m=p(n,v);return!m||!Object.hasOwnProperty.call(m,"data")?{}:u===-1||new Date().getTime()-m.time<=u?{loading:!1,data:m==null?void 0:m.data,error:void 0,returnNow:!0}:{data:m==null?void 0:m.data,error:void 0}},onRequest:function(v,m){var b=Oe(n);return b&&b!==l.current?{servicePromise:b}:(b=v.apply(void 0,y([],x(m),!1)),l.current=b,$e(n,b),{servicePromise:b})},onSuccess:function(v,m){var b;n&&((b=t.current)===null||b===void 0||b.call(t),d(n,{data:v,params:m,time:new Date().getTime()}),t.current=U(n,function(S){e.setState({data:S})}))},onMutate:function(v){var m;n&&((m=t.current)===null||m===void 0||m.call(t),d(n,{data:v,params:e.state.params,time:new Date().getTime()}),t.current=U(n,function(b){e.setState({data:b})}))}}:{}};const _e=Fe;var Ie=pe,Ne=function(){return Ie.Date.now()},Me=Ne,We=/\s/;function Le(e){for(var r=e.length;r--&&We.test(e.charAt(r)););return r}var De=Le,Be=De,ze=/^\s+/;function He(e){return e&&e.slice(0,Be(e)+1).replace(ze,"")}var Ue=He,ke=be,Ge=ye,qe="[object Symbol]";function Ve(e){return typeof e=="symbol"||Ge(e)&&ke(e)==qe}var Ke=Ve,Xe=Ue,ee=K,Ye=Ke,ne=NaN,Je=/^[-+]0x[0-9a-f]+$/i,Qe=/^0b[01]+$/i,Ze=/^0o[0-7]+$/i,en=parseInt;function nn(e){if(typeof e=="number")return e;if(Ye(e))return ne;if(ee(e)){var r=typeof e.valueOf=="function"?e.valueOf():e;e=ee(r)?r+"":r}if(typeof e!="string")return e===0?e:+e;e=Xe(e);var n=Qe.test(e);return n||Ze.test(e)?en(e.slice(2),n?2:8):Je.test(e)?ne:+e}var rn=nn,tn=K,k=Me,re=rn,an="Expected a function",on=Math.max,un=Math.min;function sn(e,r,n){var i,a,o,u,s,c,t=0,l=!1,d=!1,p=!0;if(typeof e!="function")throw new TypeError(an);r=re(r)||0,tn(n)&&(l=!!n.leading,d="maxWait"in n,o=d?on(re(n.maxWait)||0,r):o,p="trailing"in n?!!n.trailing:p);function v(h){var w=i,P=a;return i=a=void 0,t=h,u=e.apply(P,w),u}function m(h){return t=h,s=setTimeout(C,r),l?v(h):u}function b(h){var w=h-c,P=h-t,Y=r-w;return d?un(Y,o-P):Y}function S(h){var w=h-c,P=h-t;return c===void 0||w>=r||w<0||d&&P>=o}function C(){var h=k();if(S(h))return A(h);s=setTimeout(C,b(h))}function A(h){return s=void 0,p&&i?v(h):(i=a=void 0,u)}function F(){s!==void 0&&clearTimeout(s),t=0,i=c=a=s=void 0}function O(){return s===void 0?u:A(k())}function j(){var h=k(),w=S(h);if(i=arguments,a=this,c=h,w){if(s===void 0)return m(c);if(d)return clearTimeout(s),s=setTimeout(C,r),v(c)}return s===void 0&&(s=setTimeout(C,r)),u}return j.cancel=F,j.flush=O,j}var le=sn;const cn=ie(le);var ln=function(e,r){var n=r.debounceWait,i=r.debounceLeading,a=r.debounceTrailing,o=r.debounceMaxWait,u=g.useRef(),s=g.useMemo(function(){var c={};return i!==void 0&&(c.leading=i),a!==void 0&&(c.trailing=a),o!==void 0&&(c.maxWait=o),c},[i,a,o]);return g.useEffect(function(){if(n){var c=e.runAsync.bind(e);return u.current=cn(function(t){t()},n,s),e.runAsync=function(){for(var t=[],l=0;l<arguments.length;l++)t[l]=arguments[l];return new Promise(function(d,p){var v;(v=u.current)===null||v===void 0||v.call(u,function(){c.apply(void 0,y([],x(t),!1)).then(d).catch(p)})})},function(){var t;(t=u.current)===null||t===void 0||t.cancel(),e.runAsync=c}}},[n,s]),n?{onCancel:function(){var c;(c=u.current)===null||c===void 0||c.cancel()}}:{}};const fn=ln;var dn=function(e,r){var n=r.loadingDelay,i=r.ready,a=g.useRef();if(!n)return{};var o=function(){a.current&&clearTimeout(a.current)};return{onBefore:function(){return o(),i!==!1&&(a.current=setTimeout(function(){e.setState({loading:!0})},n)),{loading:!1}},onFinally:function(){o()},onCancel:function(){o()}}};const vn=dn;function X(){return W?document.visibilityState!=="hidden":!0}var _=[];function mn(e){return _.push(e),function(){var n=_.indexOf(e);_.splice(n,1)}}if(W){var hn=function(){if(X())for(var e=0;e<_.length;e++){var r=_[e];r()}};window.addEventListener("visibilitychange",hn,!1)}var gn=function(e,r){var n=r.pollingInterval,i=r.pollingWhenHidden,a=i===void 0?!0:i,o=r.pollingErrorRetryCount,u=o===void 0?-1:o,s=g.useRef(),c=g.useRef(),t=g.useRef(0),l=function(){var d;s.current&&clearTimeout(s.current),(d=c.current)===null||d===void 0||d.call(c)};return q(function(){n||l()},[n]),n?{onBefore:function(){l()},onError:function(){t.current+=1},onSuccess:function(){t.current=0},onFinally:function(){u===-1||u!==-1&&t.current<=u?s.current=setTimeout(function(){!a&&!X()?c.current=mn(function(){e.refresh()}):e.refresh()},n):t.current=0},onCancel:function(){l()}}:{}};const pn=gn;function bn(e,r){var n=!1;return function(){for(var i=[],a=0;a<arguments.length;a++)i[a]=arguments[a];n||(n=!0,e.apply(void 0,y([],x(i),!1)),setTimeout(function(){n=!1},r))}}function yn(){return W&&typeof navigator.onLine<"u"?navigator.onLine:!0}var I=[];function xn(e){return I.push(e),function(){var n=I.indexOf(e);n>-1&&I.splice(n,1)}}if(W){var te=function(){if(!(!X()||!yn()))for(var e=0;e<I.length;e++){var r=I[e];r()}};window.addEventListener("visibilitychange",te,!1),window.addEventListener("focus",te,!1)}var jn=function(e,r){var n=r.refreshOnWindowFocus,i=r.focusTimespan,a=i===void 0?5e3:i,o=g.useRef(),u=function(){var s;(s=o.current)===null||s===void 0||s.call(o)};return g.useEffect(function(){if(n){var s=bn(e.refresh.bind(e),a);o.current=xn(function(){s()})}return function(){u()}},[n,a]),V(function(){u()}),{}};const wn=jn;var Pn=function(e,r){var n=r.retryInterval,i=r.retryCount,a=g.useRef(),o=g.useRef(0),u=g.useRef(!1);return i?{onBefore:function(){u.current||(o.current=0),u.current=!1,a.current&&clearTimeout(a.current)},onSuccess:function(){o.current=0},onError:function(){if(o.current+=1,i===-1||o.current<=i){var s=n??Math.min(1e3*Math.pow(2,o.current),3e4);a.current=setTimeout(function(){u.current=!0,e.refresh()},s)}else o.current=0},onCancel:function(){o.current=0,a.current&&clearTimeout(a.current)}}:{}};const Rn=Pn;var Tn=le,Cn=K,Sn="Expected a function";function En(e,r,n){var i=!0,a=!0;if(typeof e!="function")throw new TypeError(Sn);return Cn(n)&&(i="leading"in n?!!n.leading:i,a="trailing"in n?!!n.trailing:a),Tn(e,r,{leading:i,maxWait:r,trailing:a})}var On=En;const $n=ie(On);var An=function(e,r){var n=r.throttleWait,i=r.throttleLeading,a=r.throttleTrailing,o=g.useRef(),u={};return i!==void 0&&(u.leading=i),a!==void 0&&(u.trailing=a),g.useEffect(function(){if(n){var s=e.runAsync.bind(e);return o.current=$n(function(c){c()},n,u),e.runAsync=function(){for(var c=[],t=0;t<arguments.length;t++)c[t]=arguments[t];return new Promise(function(l,d){var p;(p=o.current)===null||p===void 0||p.call(o,function(){s.apply(void 0,y([],x(c),!1)).then(l).catch(d)})})},function(){var c;e.runAsync=s,(c=o.current)===null||c===void 0||c.cancel()}}},[n,i,a]),n?{onCancel:function(){var s;(s=o.current)===null||s===void 0||s.cancel()}}:{}};const Fn=An;var _n=function(e){ae&&(oe(e)||console.error('useMount: parameter `fn` expected to be a function, but got "'.concat(typeof e,'".'))),g.useEffect(function(){e==null||e()},[])};const In=_n;var Nn=function(){var e=x(g.useState({}),2),r=e[1];return g.useCallback(function(){return r({})},[])};const Mn=Nn;var Wn=function(){function e(r,n,i,a){a===void 0&&(a={}),this.serviceRef=r,this.options=n,this.subscribe=i,this.initState=a,this.count=0,this.state={loading:!1,params:void 0,data:void 0,error:void 0},this.state=T(T(T({},this.state),{loading:!n.manual}),a)}return e.prototype.setState=function(r){r===void 0&&(r={}),this.state=T(T({},this.state),r),this.subscribe()},e.prototype.runPluginHandler=function(r){for(var n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];var a=this.pluginImpls.map(function(o){var u;return(u=o[r])===null||u===void 0?void 0:u.call.apply(u,y([o],x(n),!1))}).filter(Boolean);return Object.assign.apply(Object,y([{}],x(a),!1))},e.prototype.runAsync=function(){for(var r,n,i,a,o,u,s,c,t,l,d=[],p=0;p<arguments.length;p++)d[p]=arguments[p];return fe(this,void 0,void 0,function(){var v,m,b,S,C,A,F,O,j,h,w;return de(this,function(P){switch(P.label){case 0:if(this.count+=1,v=this.count,m=this.runPluginHandler("onBefore",d),b=m.stopNow,S=b===void 0?!1:b,C=m.returnNow,A=C===void 0?!1:C,F=ue(m,["stopNow","returnNow"]),S)return[2,new Promise(function(){})];if(this.setState(T({loading:!0,params:d},F)),A)return[2,Promise.resolve(F.data)];(n=(r=this.options).onBefore)===null||n===void 0||n.call(r,d),P.label=1;case 1:return P.trys.push([1,3,,4]),O=this.runPluginHandler("onRequest",this.serviceRef.current,d).servicePromise,O||(O=(w=this.serviceRef).current.apply(w,y([],x(d),!1))),[4,O];case 2:return j=P.sent(),v!==this.count?[2,new Promise(function(){})]:(this.setState({data:j,error:void 0,loading:!1}),(a=(i=this.options).onSuccess)===null||a===void 0||a.call(i,j,d),this.runPluginHandler("onSuccess",j,d),(u=(o=this.options).onFinally)===null||u===void 0||u.call(o,d,j,void 0),v===this.count&&this.runPluginHandler("onFinally",d,j,void 0),[2,j]);case 3:if(h=P.sent(),v!==this.count)return[2,new Promise(function(){})];throw this.setState({error:h,loading:!1}),(c=(s=this.options).onError)===null||c===void 0||c.call(s,h,d),this.runPluginHandler("onError",h,d),(l=(t=this.options).onFinally)===null||l===void 0||l.call(t,d,void 0,h),v===this.count&&this.runPluginHandler("onFinally",d,void 0,h),h;case 4:return[2]}})})},e.prototype.run=function(){for(var r=this,n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];this.runAsync.apply(this,y([],x(n),!1)).catch(function(a){r.options.onError||console.error(a)})},e.prototype.cancel=function(){this.count+=1,this.setState({loading:!1}),this.runPluginHandler("onCancel")},e.prototype.refresh=function(){this.run.apply(this,y([],x(this.state.params||[]),!1))},e.prototype.refreshAsync=function(){return this.runAsync.apply(this,y([],x(this.state.params||[]),!1))},e.prototype.mutate=function(r){var n=oe(r)?r(this.state.data):r;this.runPluginHandler("onMutate",n),this.setState({data:n})},e}();const Ln=Wn;function Dn(e,r,n){r===void 0&&(r={}),n===void 0&&(n=[]);var i=r.manual,a=i===void 0?!1:i,o=ue(r,["manual"]);ae&&r.defaultParams&&!Array.isArray(r.defaultParams)&&console.warn("expected defaultParams is array, got ".concat(typeof r.defaultParams));var u=T({manual:a},o),s=ve(e),c=Mn(),t=ce(function(){var l=n.map(function(d){var p;return(p=d==null?void 0:d.onInit)===null||p===void 0?void 0:p.call(d,u)}).filter(Boolean);return new Ln(s,u,c,Object.assign.apply(Object,y([{}],x(l),!1)))},[]);return t.options=u,t.pluginImpls=n.map(function(l){return l(t,u)}),In(function(){if(!a){var l=t.state.params||r.defaultParams||[];t.run.apply(t,y([],x(l),!1))}}),V(function(){t.cancel()}),{loading:t.state.loading,data:t.state.data,error:t.state.error,params:t.state.params||[],cancel:$(t.cancel.bind(t)),refresh:$(t.refresh.bind(t)),refreshAsync:$(t.refreshAsync.bind(t)),run:$(t.run.bind(t)),runAsync:$(t.runAsync.bind(t)),mutate:$(t.mutate.bind(t))}}function Bn(e,r,n){return Dn(e,r,y(y([],x(n||[]),!1),[fn,vn,pn,wn,Fn,Te,_e,Rn],!1))}function zn(){return me}function gr(){const[e]=R.useForm(),[r,n]=g.useState({formValue:{id:"",name:"",status:"enable"},title:"新增",show:!1,onOk:()=>{n(t=>({...t,show:!1}))},onCancel:()=>{n(t=>({...t,show:!1}))}}),i=[{title:"名稱",dataIndex:"name",width:300},{title:"順序",dataIndex:"order",align:"center",width:60},{title:"狀態",dataIndex:"status",align:"center",width:120,render:t=>f.jsx(L,{color:t==="enable"?"success":"error",children:t})},{title:"說明",dataIndex:"desc",align:"center",width:300},{title:"操作",key:"operation",align:"center",width:100,render:(t,l)=>f.jsxs("div",{className:"flex w-full justify-center text-gray",children:[f.jsx(Q,{onClick:()=>c(l),children:f.jsx(Z,{icon:"solar:pen-bold-duotone",size:18})}),f.jsx(je,{title:"Delete the Organization",okText:"Yes",cancelText:"No",placement:"left",children:f.jsx(Q,{children:f.jsx(Z,{icon:"mingcute:delete-2-fill",size:18,className:"text-error"})})})]})}],a={onChange:(t,l)=>{console.log(`🗓️ selectedRowKeys: ${t}`,"selectedRows: ",l)},onSelect:(t,l,d)=>{console.log(t,l,d)},onSelectAll:(t,l,d)=>{console.log(t,l,d)}},{data:o}=Bn(zn),u=()=>{e.resetFields()},s=()=>{n(t=>({...t,show:!0,title:"Create New",formValue:{...t.formValue,id:"",name:"",order:1,desc:"",status:"enable"}}))},c=t=>{n(l=>({...l,show:!0,title:"Edit",formValue:t}))};return f.jsxs(he,{direction:"vertical",size:"large",className:"w-full",children:[f.jsx(J,{children:f.jsx(R,{form:e,children:f.jsxs(xe,{gutter:[16,16],children:[f.jsx(B,{span:24,lg:6,children:f.jsx(R.Item,{label:"名稱",name:"name",className:"!mb-0",children:f.jsx(G,{})})}),f.jsx(B,{span:24,lg:6,children:f.jsx(R.Item,{label:"狀態",name:"status",className:"!mb-0",children:f.jsxs(z,{children:[f.jsx(z.Option,{value:"enable",children:f.jsx(L,{color:"success",children:"啟用"})}),f.jsx(z.Option,{value:"disable",children:f.jsx(L,{color:"error",children:"關閉"})})]})})}),f.jsx(B,{span:24,lg:12,children:f.jsxs("div",{className:"flex justify-end",children:[f.jsx(D,{onClick:u,children:"重置"}),f.jsx(D,{type:"primary",className:"ml-4",children:"搜尋"})]})})]})})}),f.jsx(J,{title:"組織清單",extra:f.jsx(D,{type:"primary",onClick:s,children:"新增"}),children:f.jsx(ge,{rowKey:"id",size:"small",scroll:{x:"max-content"},pagination:!1,columns:i,dataSource:o,rowSelection:{...a}})}),f.jsx(Hn,{...r})]})}function Hn({title:e,show:r,formValue:n,onOk:i,onCancel:a}){const[o]=R.useForm();return g.useEffect(()=>{o.setFieldsValue({...n})},[n,o]),f.jsx(we,{title:e,open:r,onOk:i,onCancel:a,children:f.jsxs(R,{initialValues:n,form:o,labelCol:{span:4},wrapperCol:{span:18},layout:"horizontal",children:[f.jsx(R.Item,{label:"名稱",name:"name",required:!0,children:f.jsx(G,{style:{width:"100%"}})}),f.jsx(R.Item,{label:"順序",name:"order",required:!0,children:f.jsx(Pe,{})}),f.jsx(R.Item,{label:"狀態",name:"status",required:!0,children:f.jsxs(H.Group,{optionType:"button",buttonStyle:"solid",children:[f.jsx(H,{value:"enable",children:" 啟用 "}),f.jsx(H,{value:"disable",children:" 關閉 "})]})}),f.jsx(R.Item,{label:"說明",name:"desc",children:f.jsx(G.TextArea,{})})]})})}export{gr as default};
