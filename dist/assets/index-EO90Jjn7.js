import{o as n,r as w,j as d,da as N,d7 as M,d8 as P,W as z,I as H}from"./index-tKRtgB90.js";import{u as R,K as U}from"./kanban-column-I-YUN41k.js";import{T as p,a as K,D as O}from"./kanban-task-eIYJF_Dq.js";import{I as W}from"./index-VAcXbeIy.js";import"./task-detail-Nq_yEmnd.js";import"./dayjs.min-FPul9pDH.js";import"./index-zycjR-EV.js";import"./CheckOutlined-g5MDPs9I.js";import"./EditOutlined-Z_c7PJKw.js";import"./styleChecker-ngeleDYd.js";import"./TextArea-hTdCA0yJ.js";import"./index-qxJHRbnC.js";import"./index-_0m-lzVI.js";import"./index-hPDjsNpv.js";import"./index-yW9tmOlg.js";import"./index-ByH9SYTg.js";import"./index-_Ebqtiwf.js";import"./index-FZcTj5bA.js";import"./EyeOutlined-lDKO_IOm.js";import"./addEventListener-EDtlfxlh.js";import"./index-TjmR82pg.js";import"./useShowArrow-Kbh98tcw.js";import"./List-K1aq5hik.js";import"./SearchOutlined-wP6Gi4z0.js";const f=t=>{const o=[];for(let l=0;l<t;l+=1)o.push({username:n.person.fullName(),avatar:n.image.avatarLegacy(),content:n.lorem.lines({min:1,max:3}),time:n.date.past()});return o},j=t=>{const o=[];for(let l=0;l<t;l+=1)o.push(n.image.urlPicsumPhotos());return o},g=t=>{const o=[];for(let l=0;l<t;l+=1)o.push(n.image.avatarLegacy());return o},h=t=>{const o=[],l=new Set;for(;o.length<t;){const k=n.helpers.enumValue(K);l.has(k)||(o.push(k),l.add(k))}return o},B={tasks:{"task-1":{id:"task-1",title:n.lorem.words(3),reporter:n.image.avatarLegacy(),priority:p.LOW,tags:[],comments:[],attachments:[]},"task-2":{id:"task-2",title:n.lorem.words(3),reporter:n.image.avatarLegacy(),assignee:g(1),date:n.date.future(),priority:p.HIGH,tags:h(3),comments:f(1),attachments:j(4)},"task-3":{id:"task-3",title:n.lorem.words(4),reporter:n.image.avatarLegacy(),assignee:g(2),priority:p.MEDIUM,date:n.date.future(),tags:h(2),comments:f(2),attachments:[]},"task-4":{id:"task-4",title:n.lorem.words(5),reporter:n.image.avatar(),assignee:g(3),priority:p.MEDIUM,tags:h(3),date:n.date.future(),description:n.lorem.lines(5),attachments:[],comments:f(3)},"task-5":{id:"task-5",title:n.lorem.words(4),reporter:n.image.avatar(),priority:p.HIGH,assignee:g(4),tags:h(4),date:n.date.future(),description:n.lorem.lines(3),attachments:[],comments:f(4)},"task-6":{id:"task-6",title:n.lorem.words(5),reporter:n.image.avatar(),priority:p.LOW,assignee:g(5),tags:h(5),date:n.date.future(),description:n.lorem.lines(4),attachments:j(5),comments:f(4)}},columns:{"column-1":{id:"column-1",title:"To do",taskIds:["task-1","task-2","task-3"]},"column-2":{id:"column-2",title:"In progress",taskIds:["task-4","task-5"]},"column-3":{id:"column-3",title:"Done",taskIds:["task-6"]}},columnOrder:["column-1","column-2","column-3"]};function kt(){const[t,o]=w.useState(B),l=s=>{const{source:e,destination:a,draggableId:i}=s,c=t.columns[e.droppableId],m=t.columns[a.droppableId];if(c===m){const r=Array.from(c.taskIds);r.splice(e.index,1),r.splice(a.index,0,i);const u={...c,taskIds:r},I={...t,columns:{...t.columns,[u.id]:u}};o(I)}else{const r=Array.from(c.taskIds);r.splice(e.index,1);const u={...c,taskIds:r},I=Array.from(m.taskIds);I.splice(a.index,0,i);const y={...m,taskIds:I},L={...t,columns:{...t.columns,[u.id]:u,[y.id]:y}};o(L)}},k=s=>{const{source:e,destination:a,draggableId:i}=s,c=Array.from(t.columnOrder);c.splice(e.index,1),c.splice(a.index,0,i);const m={...t,columnOrder:c};o(m)},b=s=>{const{source:e,destination:a,type:i}=s;a&&(a.droppableId===e.droppableId&&a.index===e.index||(i===O.COLUMN?k(s):l(s)))},[S,C]=w.useState(!1),x=w.useRef(null);R("click",s=>{var e,a;if(x.current&&!((e=x.current.input)!=null&&e.contains(s.target))){const i=(a=x.current.input)==null?void 0:a.value;i&&v({id:n.string.uuid(),title:i,taskIds:[]}),C(!1),console.log("click outside")}});const v=s=>{const e={...t,columns:{...t.columns,[s.id]:s},columnOrder:[...t.columnOrder,s.id]};o(e)},T=(s,e)=>{const a=t.columns[s],i={...t,tasks:{...t.tasks,[e.id]:e},columns:{...t.columns,[s]:{...a,taskIds:[...a.taskIds,e.id]}}};o(i)},D=s=>{const e=t.columns[s],a=Object.keys(t.tasks).filter(r=>!e.taskIds.includes(r)).reduce((r,u)=>(r[u]=t.tasks[u],r),{}),i=Object.keys(t.columns).filter(r=>r!==s).reduce((r,u)=>(r[u]=t.columns[u],r),{}),c=Array.from(t.columnOrder).filter(r=>r!==s);o({tasks:a,columns:i,columnOrder:c})},A=s=>{const e=t.columns[s],a=Object.keys(t.tasks).filter(m=>!e.taskIds.includes(m)).reduce((m,r)=>(m[r]=t.tasks[r],m),{}),i={...t.columns,[s]:{...e,taskIds:[]}},c={...t,tasks:a,columns:i};o(c)},E=s=>{const{id:e,title:a}=s,i={...t.columns,[e]:{...t.columns[e],title:a}},c={...t,columns:i};o(c)};return d.jsx(N,{children:d.jsxs("div",{className:"flex",children:[d.jsx(M,{onDragEnd:b,children:d.jsx(P,{droppableId:"all-columns",direction:"horizontal",type:O.COLUMN,children:s=>d.jsxs("div",{ref:s.innerRef,...s.droppableProps,className:"flex h-full items-start gap-6 p-1",children:[t.columnOrder.map((e,a)=>{const i=t.columns[e],c=i.taskIds.map(m=>t.tasks[m]);return d.jsx(U,{index:a,column:i,tasks:c,createTask:T,clearColumn:A,deleteColumn:D,renameColumn:E},e)}),s.placeholder]})})}),d.jsx("div",{className:"ml-[1.6rem] mt-[0.25rem] min-w-[280px]",children:S?d.jsx(W,{ref:x,size:"large",placeholder:"Column Name",autoFocus:!0}):d.jsx(z,{onClick:s=>{s.stopPropagation(),C(!0)},size:"large",children:d.jsxs("div",{className:"flex items-center justify-center text-xs font-500 gap-1",children:[d.jsx(H,{icon:"carbon:add",size:20}),d.jsx("div",{children:"Add Column"})]})})})]})})}export{kt as default};
